import{d as Z,r as k,a as C,i as ee,h as y,x as te,c as v,e as t,w as e,f as r,o as d,j as p,z as g,g as a,b as u,t as s,A as le,F as w,m as x,E as N,u as oe,J as ae,_ as se}from"./index-CEiZuroB.js";const ne={class:"order-detail"},re={class:"amount"},ie={class:"photo-list"},de={class:"map-placeholder"},ue={class:"log-content"},pe={class:"log-action"},ce={class:"log-user"},me={key:0,class:"log-remark"},_e=Z({__name:"detail",setup(fe){const V=ee();oe();const m=k(!1),b=C({driverId:""}),o=C({id:V.params.id,orderNo:"YS20241223001",status:"transporting",customerName:"某建筑公司",customerPhone:"13800138000",address:"郑州市金水区xxx路xxx工地",product:"P.O42.5",weight:35,price:450,amount:15750,remark:"尽快送达",driverName:"张三",driverPhone:"13800138001",vehiclePlate:"豫A11111",vehicleType:"bulk",loadWeight:35.2,unloadWeight:34.8,lossWeight:.4,freightAmount:525,signPhotos:[],createTime:"2024-12-23 08:00",dispatchTime:"2024-12-23 08:10",loadTime:"2024-12-23 08:30",departTime:"2024-12-23 08:45",signTime:""}),A=k([{id:"1",name:"张三",vehiclePlate:"豫A11111"},{id:"2",name:"李四",vehiclePlate:"豫A22222"},{id:"3",name:"王五",vehiclePlate:"豫A33333"}]),W=k([{time:"2024-12-23 08:45",action:"开始运输",operator:"系统",remark:""},{time:"2024-12-23 08:30",action:"装货完成",operator:"张三",remark:"装货重量35.2吨"},{time:"2024-12-23 08:10",action:"派单",operator:"管理员",remark:"派给张三"},{time:"2024-12-23 08:00",action:"创建订单",operator:"管理员",remark:""}]),h={pending:{label:"待派单",color:"info",step:0},dispatched:{label:"已派单",color:"warning",step:1},loading:{label:"装货中",color:"warning",step:2},transporting:{label:"运输中",color:"primary",step:3},signed:{label:"已签收",color:"success",step:4},completed:{label:"已完成",color:"success",step:5},cancelled:{label:"已取消",color:"danger",step:-1}},B=y(()=>h[o.status]?.step??0),L=y(()=>h[o.status]?.label??""),$=y(()=>h[o.status]?.color??"info"),S=()=>{N.success("派单成功"),m.value=!1},D=async()=>{await ae.confirm("确定取消此订单吗？","提示"),N.success("订单已取消")},E=()=>{window.print()};return te(()=>{}),(I,l)=>{const _=r("el-button"),M=r("el-page-header"),f=r("el-step"),z=r("el-steps"),c=r("el-card"),i=r("el-descriptions-item"),F=r("el-tag"),P=r("el-descriptions"),R=r("el-image"),T=r("el-col"),U=r("Location"),j=r("el-icon"),q=r("el-timeline-item"),J=r("el-timeline"),O=r("el-row"),Y=r("el-option"),G=r("el-select"),H=r("el-form-item"),K=r("el-form"),Q=r("el-dialog");return d(),v("div",ne,[t(M,{onBack:l[1]||(l[1]=n=>I.$router.back())},{content:e(()=>[u("span",null,"订单详情 - "+s(o.orderNo),1)]),extra:e(()=>[o.status==="pending"?(d(),p(_,{key:0,type:"primary",onClick:l[0]||(l[0]=n=>m.value=!0)},{default:e(()=>[...l[5]||(l[5]=[a("派单",-1)])]),_:1})):g("",!0),["pending","dispatched"].includes(o.status)?(d(),p(_,{key:1,type:"danger",onClick:D},{default:e(()=>[...l[6]||(l[6]=[a("取消订单",-1)])]),_:1})):g("",!0),t(_,{onClick:E},{default:e(()=>[...l[7]||(l[7]=[a("打印",-1)])]),_:1})]),_:1}),t(O,{gutter:20,style:{"margin-top":"20px"}},{default:e(()=>[t(T,{span:16},{default:e(()=>[t(c,{shadow:"never"},{header:e(()=>[...l[8]||(l[8]=[a("订单状态",-1)])]),default:e(()=>[t(z,{active:B.value,"finish-status":"success"},{default:e(()=>[t(f,{title:"创建订单",description:o.createTime},null,8,["description"]),t(f,{title:"派单",description:o.dispatchTime},null,8,["description"]),t(f,{title:"装货",description:o.loadTime},null,8,["description"]),t(f,{title:"运输",description:o.departTime},null,8,["description"]),t(f,{title:"签收",description:o.signTime},null,8,["description"])]),_:1},8,["active"])]),_:1}),t(c,{shadow:"never",style:{"margin-top":"16px"}},{header:e(()=>[...l[9]||(l[9]=[a("基本信息",-1)])]),default:e(()=>[t(P,{column:2,border:""},{default:e(()=>[t(i,{label:"订单编号"},{default:e(()=>[a(s(o.orderNo),1)]),_:1}),t(i,{label:"订单状态"},{default:e(()=>[t(F,{type:$.value},{default:e(()=>[a(s(L.value),1)]),_:1},8,["type"])]),_:1}),t(i,{label:"客户名称"},{default:e(()=>[a(s(o.customerName),1)]),_:1}),t(i,{label:"联系电话"},{default:e(()=>[a(s(o.customerPhone),1)]),_:1}),t(i,{label:"收货地址",span:2},{default:e(()=>[a(s(o.address),1)]),_:1}),t(i,{label:"水泥品种"},{default:e(()=>[a(s(o.product),1)]),_:1}),t(i,{label:"订单吨数"},{default:e(()=>[a(s(o.weight)+" 吨",1)]),_:1}),t(i,{label:"单价"},{default:e(()=>[a("¥"+s(o.price)+"/吨",1)]),_:1}),t(i,{label:"订单金额"},{default:e(()=>[u("span",re,"¥"+s(o.amount?.toLocaleString()),1)]),_:1}),t(i,{label:"备注",span:2},{default:e(()=>[a(s(o.remark||"无"),1)]),_:1})]),_:1})]),_:1}),o.driverName?(d(),p(c,{key:0,shadow:"never",style:{"margin-top":"16px"}},{header:e(()=>[...l[10]||(l[10]=[a("运输信息",-1)])]),default:e(()=>[t(P,{column:2,border:""},{default:e(()=>[t(i,{label:"司机姓名"},{default:e(()=>[a(s(o.driverName),1)]),_:1}),t(i,{label:"司机电话"},{default:e(()=>[a(s(o.driverPhone),1)]),_:1}),t(i,{label:"车牌号"},{default:e(()=>[a(s(o.vehiclePlate),1)]),_:1}),t(i,{label:"车辆类型"},{default:e(()=>[a(s(o.vehicleType==="bulk"?"散装罐车":"袋装货车"),1)]),_:1}),t(i,{label:"装货重量"},{default:e(()=>[a(s(o.loadWeight||"-")+" 吨",1)]),_:1}),t(i,{label:"卸货重量"},{default:e(()=>[a(s(o.unloadWeight||"-")+" 吨",1)]),_:1}),t(i,{label:"损耗"},{default:e(()=>[u("span",{class:le({warning:o.lossWeight>.5})},s(o.lossWeight||"-")+" 吨",3)]),_:1}),t(i,{label:"运费"},{default:e(()=>[a("¥"+s(o.freightAmount?.toLocaleString()||"-"),1)]),_:1})]),_:1})]),_:1})):g("",!0),o.signPhotos?.length?(d(),p(c,{key:1,shadow:"never",style:{"margin-top":"16px"}},{header:e(()=>[...l[11]||(l[11]=[a("签收照片",-1)])]),default:e(()=>[u("div",ie,[(d(!0),v(w,null,x(o.signPhotos,(n,X)=>(d(),p(R,{key:X,src:n,"preview-src-list":o.signPhotos,fit:"cover",class:"photo-item"},null,8,["src","preview-src-list"]))),128))])]),_:1})):g("",!0)]),_:1}),t(T,{span:8},{default:e(()=>[t(c,{shadow:"never"},{header:e(()=>[...l[12]||(l[12]=[a("运输轨迹",-1)])]),default:e(()=>[u("div",de,[t(j,{size:40,color:"#909399"},{default:e(()=>[t(U)]),_:1}),l[13]||(l[13]=u("p",null,"轨迹地图",-1))])]),_:1}),t(c,{shadow:"never",style:{"margin-top":"16px"}},{header:e(()=>[...l[14]||(l[14]=[a("操作记录",-1)])]),default:e(()=>[t(J,null,{default:e(()=>[(d(!0),v(w,null,x(W.value,n=>(d(),p(q,{key:n.time,timestamp:n.time,placement:"top"},{default:e(()=>[u("div",ue,[u("span",pe,s(n.action),1),u("span",ce,s(n.operator),1)]),n.remark?(d(),v("div",me,s(n.remark),1)):g("",!0)]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(Q,{modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=n=>m.value=n),title:"派单",width:"500"},{footer:e(()=>[t(_,{onClick:l[3]||(l[3]=n=>m.value=!1)},{default:e(()=>[...l[15]||(l[15]=[a("取消",-1)])]),_:1}),t(_,{type:"primary",onClick:S},{default:e(()=>[...l[16]||(l[16]=[a("确认派单",-1)])]),_:1})]),default:e(()=>[t(K,{model:b,"label-width":"80px"},{default:e(()=>[t(H,{label:"选择司机",required:""},{default:e(()=>[t(G,{modelValue:b.driverId,"onUpdate:modelValue":l[2]||(l[2]=n=>b.driverId=n),placeholder:"请选择司机",style:{width:"100%"}},{default:e(()=>[(d(!0),v(w,null,x(A.value,n=>(d(),p(Y,{key:n.id,label:`${n.name} - ${n.vehiclePlate}`,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),ge=se(_e,[["__scopeId","data-v-a30d6e2c"]]);export{ge as default};
