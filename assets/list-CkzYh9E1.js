import{d as X,h as Q,r as V,a as L,C as se,j as B,w as l,f as d,o as c,e,g as p,c as T,l as S,G as R,E as M,_ as Z,x as de,I as ie,b as m,t as b,k as ue,D as re,A as pe,F as me,m as ce,J as fe}from"./index-CEiZuroB.js";const _e=["src"],ve=["src"],ye=["src"],ge=X({__name:"DriverFormDialog",props:{modelValue:{type:Boolean},data:{}},emits:["update:modelValue","success"],setup(H,{emit:A}){const D=H,U=A,w=Q({get:()=>D.modelValue,set:$=>U("update:modelValue",$)}),z=Q(()=>!!D.data?.id),i=V(!1),k=V("basic"),x=V(),W={id:"",name:"",phone:"",idCard:"",type:"own",licenseNo:"",licenseExpiry:"",entryDate:"",status:"active",idCardFront:"",idCardBack:"",driverLicense:"",bankName:"",bankAccount:"",emergencyContact:"",emergencyPhone:""},s=L({...W}),O={name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1\d{10}$/,message:"手机号格式不正确",trigger:"blur"}],idCard:[{required:!0,message:"请输入身份证号",trigger:"blur"}],type:[{required:!0,message:"请选择司机类型",trigger:"change"}]};se(()=>D.data,$=>{$?Object.assign(s,$):Object.assign(s,W),k.value="basic"},{immediate:!0});const N=()=>{w.value=!1},G=async()=>{await x.value?.validate(),i.value=!0,setTimeout(()=>{M.success(z.value?"修改成功":"创建成功"),i.value=!1,w.value=!1,U("success")},500)};return($,o)=>{const v=d("el-input"),u=d("el-form-item"),r=d("el-col"),C=d("el-row"),q=d("el-radio"),J=d("el-radio-group"),f=d("el-date-picker"),a=d("el-switch"),E=d("el-tab-pane"),y=d("el-icon"),h=d("el-upload"),F=d("el-tabs"),_=d("el-form"),Y=d("el-button"),j=d("el-dialog");return c(),B(j,{modelValue:w.value,"onUpdate:modelValue":o[13]||(o[13]=n=>w.value=n),title:z.value?"编辑司机":"新增司机",width:"700","close-on-click-modal":!1},{footer:l(()=>[e(Y,{onClick:N},{default:l(()=>[...o[16]||(o[16]=[p("取消",-1)])]),_:1}),e(Y,{type:"primary",loading:i.value,onClick:G},{default:l(()=>[...o[17]||(o[17]=[p("确定",-1)])]),_:1},8,["loading"])]),default:l(()=>[e(_,{model:s,rules:O,ref_key:"formRef",ref:x,"label-width":"100px"},{default:l(()=>[e(F,{modelValue:k.value,"onUpdate:modelValue":o[12]||(o[12]=n=>k.value=n)},{default:l(()=>[e(E,{label:"基本信息",name:"basic"},{default:l(()=>[e(C,{gutter:20},{default:l(()=>[e(r,{span:12},{default:l(()=>[e(u,{label:"姓名",prop:"name"},{default:l(()=>[e(v,{modelValue:s.name,"onUpdate:modelValue":o[0]||(o[0]=n=>s.name=n),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:l(()=>[e(u,{label:"手机号",prop:"phone"},{default:l(()=>[e(v,{modelValue:s.phone,"onUpdate:modelValue":o[1]||(o[1]=n=>s.phone=n),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{gutter:20},{default:l(()=>[e(r,{span:12},{default:l(()=>[e(u,{label:"身份证号",prop:"idCard"},{default:l(()=>[e(v,{modelValue:s.idCard,"onUpdate:modelValue":o[2]||(o[2]=n=>s.idCard=n),placeholder:"请输入身份证号"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:l(()=>[e(u,{label:"司机类型",prop:"type"},{default:l(()=>[e(J,{modelValue:s.type,"onUpdate:modelValue":o[3]||(o[3]=n=>s.type=n)},{default:l(()=>[e(q,{value:"own"},{default:l(()=>[...o[14]||(o[14]=[p("自有司机",-1)])]),_:1}),e(q,{value:"external"},{default:l(()=>[...o[15]||(o[15]=[p("外协司机",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{gutter:20},{default:l(()=>[e(r,{span:12},{default:l(()=>[e(u,{label:"驾驶证号",prop:"licenseNo"},{default:l(()=>[e(v,{modelValue:s.licenseNo,"onUpdate:modelValue":o[4]||(o[4]=n=>s.licenseNo=n),placeholder:"请输入驾驶证号"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:l(()=>[e(u,{label:"有效期至",prop:"licenseExpiry"},{default:l(()=>[e(f,{modelValue:s.licenseExpiry,"onUpdate:modelValue":o[5]||(o[5]=n=>s.licenseExpiry=n),type:"date",placeholder:"选择日期","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{gutter:20},{default:l(()=>[e(r,{span:12},{default:l(()=>[e(u,{label:"入职日期"},{default:l(()=>[e(f,{modelValue:s.entryDate,"onUpdate:modelValue":o[6]||(o[6]=n=>s.entryDate=n),type:"date",placeholder:"选择日期","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:l(()=>[e(u,{label:"状态"},{default:l(()=>[e(a,{modelValue:s.status,"onUpdate:modelValue":o[7]||(o[7]=n=>s.status=n),"active-value":"active","inactive-value":"inactive","active-text":"在职","inactive-text":"离职"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{label:"证件照片",name:"docs"},{default:l(()=>[e(C,{gutter:20},{default:l(()=>[e(r,{span:8},{default:l(()=>[e(u,{label:"身份证正面"},{default:l(()=>[e(h,{class:"avatar-uploader",action:"#","show-file-list":!1,"auto-upload":!1},{default:l(()=>[s.idCardFront?(c(),T("img",{key:0,src:s.idCardFront,class:"avatar"},null,8,_e)):(c(),B(y,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[e(S(R))]),_:1}))]),_:1})]),_:1})]),_:1}),e(r,{span:8},{default:l(()=>[e(u,{label:"身份证反面"},{default:l(()=>[e(h,{class:"avatar-uploader",action:"#","show-file-list":!1,"auto-upload":!1},{default:l(()=>[s.idCardBack?(c(),T("img",{key:0,src:s.idCardBack,class:"avatar"},null,8,ve)):(c(),B(y,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[e(S(R))]),_:1}))]),_:1})]),_:1})]),_:1}),e(r,{span:8},{default:l(()=>[e(u,{label:"驾驶证"},{default:l(()=>[e(h,{class:"avatar-uploader",action:"#","show-file-list":!1,"auto-upload":!1},{default:l(()=>[s.driverLicense?(c(),T("img",{key:0,src:s.driverLicense,class:"avatar"},null,8,ye)):(c(),B(y,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[e(S(R))]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{label:"结算信息",name:"bank"},{default:l(()=>[e(C,{gutter:20},{default:l(()=>[e(r,{span:12},{default:l(()=>[e(u,{label:"开户银行"},{default:l(()=>[e(v,{modelValue:s.bankName,"onUpdate:modelValue":o[8]||(o[8]=n=>s.bankName=n),placeholder:"请输入开户银行"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:l(()=>[e(u,{label:"银行账号"},{default:l(()=>[e(v,{modelValue:s.bankAccount,"onUpdate:modelValue":o[9]||(o[9]=n=>s.bankAccount=n),placeholder:"请输入银行账号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(C,{gutter:20},{default:l(()=>[e(r,{span:12},{default:l(()=>[e(u,{label:"紧急联系人"},{default:l(()=>[e(v,{modelValue:s.emergencyContact,"onUpdate:modelValue":o[10]||(o[10]=n=>s.emergencyContact=n),placeholder:"请输入紧急联系人"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:l(()=>[e(u,{label:"紧急联系电话"},{default:l(()=>[e(v,{modelValue:s.emergencyPhone,"onUpdate:modelValue":o[11]||(o[11]=n=>s.emergencyPhone=n),placeholder:"请输入电话"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),be=Z(ge,[["__scopeId","data-v-3e41aff5"]]),Ve={class:"driver-list"},we={class:"stat-value"},ke={class:"stat-value success"},xe={class:"stat-value primary"},Ce={class:"stat-value warning"},he={class:"stat-value danger"},De={class:"stat-value"},Ue={key:0},Ee=X({__name:"list",setup(H){const A=V(!1),D=V(!1),U=V(!1),w=V(null),z=V(""),i=L({name:"",phone:"",type:"",status:""}),k=L({page:1,size:10,total:52}),x=L({total:52,active:48,own:28,external:24,licenseExpiring:3,unBindVehicle:5}),W=V([{id:"10",plate:"豫A10101",capacity:35},{id:"11",plate:"豫A10102",capacity:32}]),s=V([{id:"1",name:"张三",phone:"13800138001",idCard:"410***********1234",vehiclePlate:"豫A11111",type:"own",licenseExpiry:"2025-06-30",status:"active",monthTrips:28,monthWeight:980,entryDate:"2023-01-15"},{id:"2",name:"李四",phone:"13800138002",idCard:"410***********2345",vehiclePlate:"豫A22222",type:"own",licenseExpiry:"2025-03-15",status:"active",monthTrips:25,monthWeight:875,entryDate:"2023-02-20"},{id:"3",name:"王五",phone:"13800138003",idCard:"410***********3456",vehiclePlate:"豫A33333",type:"external",licenseExpiry:"2025-01-20",status:"active",monthTrips:30,monthWeight:1050,entryDate:"2023-03-10"},{id:"4",name:"赵六",phone:"13800138004",idCard:"410***********4567",vehiclePlate:"",type:"external",licenseExpiry:"2025-08-10",status:"active",monthTrips:0,monthWeight:0,entryDate:"2023-04-05"},{id:"5",name:"钱七",phone:"13800138005",idCard:"410***********5678",vehiclePlate:"豫A55555",type:"own",licenseExpiry:"2025-12-01",status:"active",monthTrips:22,monthWeight:770,entryDate:"2023-05-18"}]),O=f=>{const a=new Date(f),E=new Date;return(a.getTime()-E.getTime())/(1e3*60*60*24)<90},N=()=>{A.value=!0,setTimeout(()=>{A.value=!1},300)},G=()=>N(),$=()=>{i.name="",i.phone="",i.type="",i.status=""},o=()=>{w.value=null,D.value=!0},v=f=>{w.value={...f},D.value=!0},u=f=>{M.info(`查看${f.name}详情`)},r=f=>{w.value=f,z.value="",U.value=!0},C=()=>{M.success("绑定成功"),U.value=!1},q=async f=>{await fe.confirm("确定删除该司机吗？","提示"),M.success("删除成功")},J=()=>{M.info("导出司机列表")};return de(N),(f,a)=>{const E=d("el-input"),y=d("el-form-item"),h=d("el-option"),F=d("el-select"),_=d("el-button"),Y=d("el-icon"),j=d("el-form"),n=d("el-card"),P=d("el-col"),ee=d("el-row"),le=d("el-link"),g=d("el-table-column"),K=d("el-tag"),ae=d("el-table"),te=d("el-pagination"),oe=d("el-dialog"),ne=re("loading");return c(),T("div",Ve,[e(n,{shadow:"never"},{default:l(()=>[e(j,{model:i,inline:""},{default:l(()=>[e(y,{label:"姓名"},{default:l(()=>[e(E,{modelValue:i.name,"onUpdate:modelValue":a[0]||(a[0]=t=>i.name=t),placeholder:"请输入",clearable:"",style:{width:"120px"}},null,8,["modelValue"])]),_:1}),e(y,{label:"手机号"},{default:l(()=>[e(E,{modelValue:i.phone,"onUpdate:modelValue":a[1]||(a[1]=t=>i.phone=t),placeholder:"请输入",clearable:"",style:{width:"140px"}},null,8,["modelValue"])]),_:1}),e(y,{label:"类型"},{default:l(()=>[e(F,{modelValue:i.type,"onUpdate:modelValue":a[2]||(a[2]=t=>i.type=t),placeholder:"请选择",clearable:"",style:{width:"120px"}},{default:l(()=>[e(h,{label:"自有司机",value:"own"}),e(h,{label:"外协司机",value:"external"})]),_:1},8,["modelValue"])]),_:1}),e(y,{label:"状态"},{default:l(()=>[e(F,{modelValue:i.status,"onUpdate:modelValue":a[3]||(a[3]=t=>i.status=t),placeholder:"请选择",clearable:"",style:{width:"100px"}},{default:l(()=>[e(h,{label:"在职",value:"active"}),e(h,{label:"离职",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(y,null,{default:l(()=>[e(_,{type:"primary",onClick:G},{default:l(()=>[...a[10]||(a[10]=[p("查询",-1)])]),_:1}),e(_,{onClick:$},{default:l(()=>[...a[11]||(a[11]=[p("重置",-1)])]),_:1}),e(_,{type:"primary",onClick:o},{default:l(()=>[e(Y,null,{default:l(()=>[e(S(R))]),_:1}),a[12]||(a[12]=p(" 新增司机 ",-1))]),_:1}),e(_,{onClick:J},{default:l(()=>[e(Y,null,{default:l(()=>[e(S(ie))]),_:1}),a[13]||(a[13]=p(" 导出 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(ee,{gutter:20,style:{"margin-top":"16px"}},{default:l(()=>[e(P,{span:4},{default:l(()=>[e(n,{shadow:"never",class:"stat-card"},{default:l(()=>[m("div",we,b(x.total),1),a[14]||(a[14]=m("div",{class:"stat-label"},"司机总数",-1))]),_:1})]),_:1}),e(P,{span:4},{default:l(()=>[e(n,{shadow:"never",class:"stat-card"},{default:l(()=>[m("div",ke,b(x.active),1),a[15]||(a[15]=m("div",{class:"stat-label"},"在职",-1))]),_:1})]),_:1}),e(P,{span:4},{default:l(()=>[e(n,{shadow:"never",class:"stat-card"},{default:l(()=>[m("div",xe,b(x.own),1),a[16]||(a[16]=m("div",{class:"stat-label"},"自有司机",-1))]),_:1})]),_:1}),e(P,{span:4},{default:l(()=>[e(n,{shadow:"never",class:"stat-card"},{default:l(()=>[m("div",Ce,b(x.external),1),a[17]||(a[17]=m("div",{class:"stat-label"},"外协司机",-1))]),_:1})]),_:1}),e(P,{span:4},{default:l(()=>[e(n,{shadow:"never",class:"stat-card"},{default:l(()=>[m("div",he,b(x.licenseExpiring),1),a[18]||(a[18]=m("div",{class:"stat-label"},"证件即将过期",-1))]),_:1})]),_:1}),e(P,{span:4},{default:l(()=>[e(n,{shadow:"never",class:"stat-card"},{default:l(()=>[m("div",De,b(x.unBindVehicle),1),a[19]||(a[19]=m("div",{class:"stat-label"},"未绑定车辆",-1))]),_:1})]),_:1})]),_:1}),e(n,{shadow:"never",style:{"margin-top":"16px"}},{default:l(()=>[ue((c(),B(ae,{data:s.value,stripe:""},{default:l(()=>[e(g,{prop:"name",label:"姓名",width:"100"},{default:l(({row:t})=>[e(le,{type:"primary",onClick:I=>v(t)},{default:l(()=>[p(b(t.name),1)]),_:2},1032,["onClick"])]),_:1}),e(g,{prop:"phone",label:"手机号",width:"130"}),e(g,{prop:"idCard",label:"身份证号",width:"180"}),e(g,{prop:"vehiclePlate",label:"绑定车辆",width:"120"},{default:l(({row:t})=>[t.vehiclePlate?(c(),T("span",Ue,b(t.vehiclePlate),1)):(c(),B(_,{key:1,link:"",type:"primary",size:"small",onClick:I=>r(t)},{default:l(()=>[...a[20]||(a[20]=[p("绑定",-1)])]),_:1},8,["onClick"]))]),_:1}),e(g,{prop:"type",label:"类型",width:"100"},{default:l(({row:t})=>[e(K,{type:t.type==="own"?"primary":"warning",size:"small"},{default:l(()=>[p(b(t.type==="own"?"自有":"外协"),1)]),_:2},1032,["type"])]),_:1}),e(g,{prop:"licenseExpiry",label:"驾驶证有效期",width:"120"},{default:l(({row:t})=>[m("span",{class:pe({"text-danger":O(t.licenseExpiry)})},b(t.licenseExpiry),3)]),_:1}),e(g,{prop:"status",label:"状态",width:"80"},{default:l(({row:t})=>[e(K,{type:t.status==="active"?"success":"info",size:"small"},{default:l(()=>[p(b(t.status==="active"?"在职":"离职"),1)]),_:2},1032,["type"])]),_:1}),e(g,{prop:"monthTrips",label:"本月趟次",width:"100",align:"center"}),e(g,{prop:"monthWeight",label:"本月吨数",width:"100",align:"center"}),e(g,{prop:"entryDate",label:"入职日期",width:"110"}),e(g,{label:"操作",width:"160",fixed:"right"},{default:l(({row:t})=>[e(_,{link:"",type:"primary",onClick:I=>v(t)},{default:l(()=>[...a[21]||(a[21]=[p("编辑",-1)])]),_:1},8,["onClick"]),e(_,{link:"",type:"primary",onClick:I=>u(t)},{default:l(()=>[...a[22]||(a[22]=[p("详情",-1)])]),_:1},8,["onClick"]),e(_,{link:"",type:"danger",onClick:I=>q(t)},{default:l(()=>[...a[23]||(a[23]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ne,A.value]]),e(te,{style:{"margin-top":"16px","justify-content":"flex-end"},"current-page":k.page,"onUpdate:currentPage":a[4]||(a[4]=t=>k.page=t),"page-size":k.size,"onUpdate:pageSize":a[5]||(a[5]=t=>k.size=t),total:k.total,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next"},null,8,["current-page","page-size","total"])]),_:1}),e(be,{modelValue:D.value,"onUpdate:modelValue":a[6]||(a[6]=t=>D.value=t),data:w.value,onSuccess:N},null,8,["modelValue","data"]),e(oe,{modelValue:U.value,"onUpdate:modelValue":a[9]||(a[9]=t=>U.value=t),title:"绑定车辆",width:"400"},{footer:l(()=>[e(_,{onClick:a[8]||(a[8]=t=>U.value=!1)},{default:l(()=>[...a[24]||(a[24]=[p("取消",-1)])]),_:1}),e(_,{type:"primary",onClick:C},{default:l(()=>[...a[25]||(a[25]=[p("确定",-1)])]),_:1})]),default:l(()=>[e(j,{"label-width":"80px"},{default:l(()=>[e(y,{label:"选择车辆"},{default:l(()=>[e(F,{modelValue:z.value,"onUpdate:modelValue":a[7]||(a[7]=t=>z.value=t),placeholder:"请选择车辆",style:{width:"100%"}},{default:l(()=>[(c(!0),T(me,null,ce(W.value,t=>(c(),B(h,{key:t.id,label:`${t.plate} (${t.capacity}吨)`,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Be=Z(Ee,[["__scopeId","data-v-aa6daefb"]]);export{Be as default};
