import{d as M,r as c,a as O,c as h,e,w as t,f as s,o as f,j as g,z as S,F as A,m as I,g as r,t as V,b as C,E as x,J,_ as K}from"./index-CEiZuroB.js";const L={class:"system-role"},G={class:"card-header"},H=M({__name:"role",setup(P){const n=c(!1),d=c(!1),b=c(),k=c(),o=O({id:"",name:"",code:"",permissions:[],remark:""}),w={name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],code:[{required:!0,message:"请输入角色编码",trigger:"blur"}]},E={"order:list":"订单查看","order:create":"创建订单","order:dispatch":"派单","driver:list":"司机查看","driver:edit":"司机编辑","vehicle:list":"车辆查看","vehicle:edit":"车辆编辑","finance:list":"财务查看","finance:settle":"财务结算","monitor:list":"监控查看","system:user":"用户管理","system:role":"角色管理"},T=[{name:"订单管理",code:"order",children:[{name:"订单查看",code:"order:list"},{name:"创建订单",code:"order:create"},{name:"派单",code:"order:dispatch"}]},{name:"司机管理",code:"driver",children:[{name:"司机查看",code:"driver:list"},{name:"司机编辑",code:"driver:edit"}]},{name:"车辆管理",code:"vehicle",children:[{name:"车辆查看",code:"vehicle:list"},{name:"车辆编辑",code:"vehicle:edit"}]},{name:"财务管理",code:"finance",children:[{name:"财务查看",code:"finance:list"},{name:"财务结算",code:"finance:settle"}]},{name:"监控中心",code:"monitor",children:[{name:"监控查看",code:"monitor:list"}]},{name:"系统管理",code:"system",children:[{name:"用户管理",code:"system:user"},{name:"角色管理",code:"system:role"}]}],B=c([{id:"1",name:"超级管理员",code:"admin",permissions:["order:list","order:create","order:dispatch","driver:list","driver:edit","vehicle:list","vehicle:edit","finance:list","finance:settle","monitor:list","system:user","system:role"],remark:"拥有所有权限",createTime:"2024-01-01 00:00"},{id:"2",name:"调度员",code:"dispatcher",permissions:["order:list","order:create","order:dispatch","driver:list","vehicle:list","monitor:list"],remark:"负责订单调度",createTime:"2024-01-01 00:00"},{id:"3",name:"财务",code:"finance",permissions:["order:list","finance:list","finance:settle"],remark:"负责财务结算",createTime:"2024-01-01 00:00"}]),N=()=>{d.value=!1,Object.assign(o,{id:"",name:"",code:"",permissions:[],remark:""}),n.value=!0},R=_=>{d.value=!0,Object.assign(o,_),n.value=!0},U=async()=>{await b.value?.validate(),o.permissions=k.value.getCheckedKeys(),x.success(d.value?"修改成功":"创建成功"),n.value=!1},j=async _=>{await J.confirm("确定删除该角色吗？","提示"),x.success("删除成功")};return(_,l)=>{const m=s("el-button"),i=s("el-table-column"),y=s("el-tag"),z=s("el-table"),D=s("el-card"),v=s("el-input"),u=s("el-form-item"),$=s("el-tree"),q=s("el-form"),F=s("el-dialog");return f(),h("div",L,[e(D,{shadow:"never"},{header:t(()=>[C("div",G,[l[6]||(l[6]=C("span",null,"角色管理",-1)),e(m,{type:"primary",onClick:N},{default:t(()=>[...l[5]||(l[5]=[r("新增角色",-1)])]),_:1})])]),default:t(()=>[e(z,{data:B.value,stripe:""},{default:t(()=>[e(i,{prop:"name",label:"角色名称",width:"150"}),e(i,{prop:"code",label:"角色编码",width:"150"}),e(i,{prop:"permissions",label:"权限"},{default:t(({row:a})=>[(f(!0),h(A,null,I(a.permissions.slice(0,5),p=>(f(),g(y,{key:p,size:"small",style:{"margin-right":"4px"}},{default:t(()=>[r(V(E[p]),1)]),_:2},1024))),128)),a.permissions.length>5?(f(),g(y,{key:0,size:"small",type:"info"},{default:t(()=>[r("+"+V(a.permissions.length-5),1)]),_:2},1024)):S("",!0)]),_:1}),e(i,{prop:"remark",label:"备注"}),e(i,{prop:"createTime",label:"创建时间",width:"180"}),e(i,{label:"操作",width:"150",fixed:"right"},{default:t(({row:a})=>[e(m,{link:"",type:"primary",onClick:p=>R(a)},{default:t(()=>[...l[7]||(l[7]=[r("编辑",-1)])]),_:1},8,["onClick"]),e(m,{link:"",type:"danger",onClick:p=>j(a),disabled:a.code==="admin"},{default:t(()=>[...l[8]||(l[8]=[r("删除",-1)])]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["data"])]),_:1}),e(F,{modelValue:n.value,"onUpdate:modelValue":l[4]||(l[4]=a=>n.value=a),title:d.value?"编辑角色":"新增角色",width:"600"},{footer:t(()=>[e(m,{onClick:l[3]||(l[3]=a=>n.value=!1)},{default:t(()=>[...l[9]||(l[9]=[r("取消",-1)])]),_:1}),e(m,{type:"primary",onClick:U},{default:t(()=>[...l[10]||(l[10]=[r("确定",-1)])]),_:1})]),default:t(()=>[e(q,{model:o,rules:w,ref_key:"formRef",ref:b,"label-width":"80px"},{default:t(()=>[e(u,{label:"角色名称",prop:"name"},{default:t(()=>[e(v,{modelValue:o.name,"onUpdate:modelValue":l[0]||(l[0]=a=>o.name=a),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1}),e(u,{label:"角色编码",prop:"code"},{default:t(()=>[e(v,{modelValue:o.code,"onUpdate:modelValue":l[1]||(l[1]=a=>o.code=a),placeholder:"请输入角色编码",disabled:d.value},null,8,["modelValue","disabled"])]),_:1}),e(u,{label:"权限",prop:"permissions"},{default:t(()=>[e($,{ref_key:"treeRef",ref:k,data:T,"show-checkbox":"","node-key":"code","default-checked-keys":o.permissions,props:{label:"name",children:"children"}},null,8,["default-checked-keys"])]),_:1}),e(u,{label:"备注"},{default:t(()=>[e(v,{modelValue:o.remark,"onUpdate:modelValue":l[2]||(l[2]=a=>o.remark=a),type:"textarea",rows:2},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),W=K(H,[["__scopeId","data-v-5ed77939"]]);export{W as default};
